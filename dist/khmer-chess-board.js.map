{"version":3,"sources":["webpack://khmer-chess-board/webpack/universalModuleDefinition","webpack://khmer-chess-board/./index.js","webpack://khmer-chess-board/./src/Graveyard.js","webpack://khmer-chess-board/./src/SquarePiece.js","webpack://khmer-chess-board/./src/index.js","webpack://khmer-chess-board/./src/svg.js","webpack://khmer-chess-board/../khmer-chess/index.js","webpack://khmer-chess-board/../khmer-chess/src/KPGN.js","webpack://khmer-chess-board/../khmer-chess/src/KhmerChess.js","webpack://khmer-chess-board/../khmer-chess/src/REN.js","webpack://khmer-chess-board/../khmer-chess/src/board-helper.js","webpack://khmer-chess-board/../khmer-chess/src/gen-mask.js","webpack://khmer-chess-board/../khmer-chess/src/jsis.js","webpack://khmer-chess-board/../khmer-chess/src/move-helper.js","webpack://khmer-chess-board/../khmer-chess/src/ren-helper.js","webpack://khmer-chess-board/webpack/bootstrap","webpack://khmer-chess-board/webpack/startup"],"names":["root","factory","exports","module","define","amd","a","i","self","Graveyard","require","addCss","drawBoard","BORDER_WIDTH","MIN_SQUARE_WIDTH","TD_GRAVEYARD_NUMBER","config","khmerChess","KhmerChess","Piece","boardHelper","KhmerChessBoard","options","width","container","Error","this","minWidth","ROW_NUMBER","call","renderKhmerChess","renStr","load","graveyard","get","removePiece","forEach","p","setPiece","type","color","board","arr","j","square","squares","name","version","console","log","squarePiece","push","index","SquarePiece","x","y","piece","isGraveyard","document","createElement","HORIZONTAL_CODE_LETTERS","h","v","drawPiece","classList","remove","add","PIECES_SVG","TABLE_CLASS","squareWidth","pieceFontSize","css","getColorArray","getPieceCharArray","encodeURIComponent","head","getElementsByTagName","style","appendChild","styleSheet","cssText","createTextNode","createTable","parent","table","createTbody","tbody","createTr","tr","createTd","td","cursor","squaresIndex","indexCode","Object","keys","key","graveyardContainerHeight","height","trGraveyardContainer","tdGraveyardContainer","addEventListener","e","scrollLeft","wheelDelta","preventDefault","overflowX","overflowY","colSpan","padding","boxShadow","tableGraveyard","graveyardWidth","trGraveyard","tdGraveyard","fSize","addBackground","target","tObjects","bgImg","obj","t","backgroundImage","backgroundRepeat","c","WOOD_COLORS","filterId","SVG_FILTER","PIECE_COLOR_WHITE","PIECE_TYPE_TOUK","PIECE_TYPE_SES","PIECE_TYPE_KOL","PIECE_TYPE_SDECH","PIECE_TYPE_NEANG","PIECE_TYPE_TREY","PIECE_TYPE_BORK","PIECE_COLOR_BLACK","REN","renHelper","KPGN","Player","id","Result","win","draw","lost","Move","from","to","jump","capture","Timer","totalSecond","currentWhite","currentBlack","kpgnJson","white","black","last","whiteWin","blackWin","event","date","location","players","toJson","result","moves","map","m","ren","toString","timer","MoveHelper","toRen","renInstance","valid","error_number","error","message","toMultiArray","pieces","kpgnInstance","kpgnJosn","reduce","s","subArr","rs","join","bottom","length","gyTStr","gyStr","gyBStr","graveyardStr","turn","move","squareId","listener","jsis","DEFAULT_BOARD_STR","NOT_SET","isUndefined","toWhitePiece","isUpperCase","toLowerCase","isWhite","Pos","indexOf","toPString","isNull","EMPTY_PIECE","Board","boardStr","Array","getSubBoardNumber","_","codeP","numToCodeP","newBoardStr","extract","replace","isValidPiecesString","poses","split","pos","str","reg","RegExp","$1","BOARD_SEPARATOR","toStringFull","compress","KqMoved","kqMovedStr","bh","whiteKing","whiteQueen","blackKing","blackQueen","KAttacked","kAttackedStr","CountDown","countdownStr","newCountdownStr","isStringNumber","Number","turnStr","kqMoved","countdown","invalidPiecesString","isInvalidPieceCount","piecesCount","filter","concat","toOrigin","k","sort","kAttacked","genMask","Rectangle","point","allPiecesString","ROW_FIRST_INDEX","ROW_LAST_INDEX","mask","onlyPiece","ruler","some","toUpperCase","isValidPosXY","rect","isContainsPoint","isValidPiece","isBlack","res","nerdPosToXY","isNumber","Math","floor","nerdXyToPos","isPosInBoard","posInBoard","getCharPieceFromString","piecesString","charAt","getPieceProperties","code","pieceHash","PIECE_COLOR_EMPTY","getCharPieceInPos","getPieceInPos","isString","pr","convertMask","sign","getPieceCanMovePoses","_pos","getPieceCanMovePosesValid","distPiece","_poses","n","thisPos","_x","_y","_n","_s","abs","replacePiecesString","substring","injectPiece","pos1","pos2","isCharPiecesInBoard","getPieceCode","val","getKingWillInDanger","kingPos","numToCode","getKingInDanger","number","generatePosesCanMove","isHaveMoved","isHaveCaptured","getPiecesInBoard","filterPieceInBoard","prop","whitePieces","blackPieces","extractPiecesToArray","pieceAll","isStateCount","checkCountable","weaker","stronger","oppositeColor","checkCount","force","countChar","count","toukCount","getHashKey","getPieceKeyByProp","prop1","getPieceKeyByName","isValid","isNotEmpty","isValidString","isNaN","isArray","isFunction","f","isObject","o","isBoolean","b","isTrue","isValidBoolean","isFalse","isPoint","isValidObject","isValidNumber","isSize","size","isOdd","isEven","option","currentTurn","isNeangMoved","isSdechMoved","genCanMove","genCanMoveForAnother","whiteMoves","blackMoves","whiteKingInDanger","whiteKingWillInDanger","blackKingInDanger","blackKingWillInDanger","winColor","stuckColor","genMoves","isSdech","isNeang","canMoveIndexes","cleanMoves","splice","init","generateCanMoves","cleanPieceNoMove","anotherMoves","checkIfKingInDanger","genWinLost","getStuck","blackCountable","whiteCountable","countingBlack","countingWhite","fen","fenArr","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__"],"mappings":"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","file":"khmer-chess-board.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, function() {\nreturn ","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n/*\n  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓\n8 ┃   ┃   ┃   ┃   ┃ k ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n7 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n6 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n5 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n4 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n3 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n2 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n1 ┃   ┃   ┃   ┃ K ┃   ┃   ┃   ┃   ┃\n  ┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛\n    a   b   c   d   e   f   g   h\n  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓\n  ┃ b ┃ h ┃ g ┃ q ┃ g ┃ h ┃ b ┃ f ┃ f ┃ f ┃ f ┃ f ┃ f ┃ f ┃ f ┃ F ┃ F ┃ F ┃ F ┃ F ┃ F ┃ F ┃ F ┃ B ┃ H ┃ G ┃ Q ┃ G ┃ H ┃ B ┃\n  ┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛\n */\n\"use strict\";\n\nconst { Graveyard } = require('./src/Graveyard');\nconst {\n    addCss,\n    drawBoard,\n    BORDER_WIDTH,\n    MIN_SQUARE_WIDTH,\n    TD_GRAVEYARD_NUMBER,\n} = require('./src');\nconst config = require('./package.json');\nconst khmerChess = require('khmer-chess');\n\nconst { KhmerChess, Piece, boardHelper } = khmerChess;\n\nclass KhmerChessBoard {\n    static name = config.name;\n    static version = config.version;\n    static BORDER_WIDTH;\n    static MIN_SQUARE_WIDTH;\n    static TD_GRAVEYARD_NUMBER;\n    static TABLE_CLASS;\n    options = {\n        width: 500,\n        container: null\n    };\n    squares = [];\n    squaresIndex = {};\n    graveyard = new Graveyard();\n    khmerChess = new KhmerChess();\n    constructor(options = {}) {\n        if (!options.container) {\n            throw new Error('Container is required!');\n        }\n        this.options.container = options.container;\n\n        const minWidth = (boardHelper.ROW_NUMBER - 1) * BORDER_WIDTH + boardHelper.ROW_NUMBER * MIN_SQUARE_WIDTH;\n        if (options.width < minWidth) {\n            throw new Error(`Board width must more than ${minWidth}`);\n        }\n        if (options.width) {\n            this.options.width = options.width;\n        }\n\n        addCss.call(this);\n        drawBoard.call(this);\n        this.renderKhmerChess();\n    }\n\n    loadRen(renStr) {\n        this.khmerChess.load(renStr);\n        this.renderKhmerChess();\n    }\n\n    squareWidth() {\n        const squareWidth = (this.options.width - (boardHelper.ROW_NUMBER - 1) * BORDER_WIDTH) / boardHelper.ROW_NUMBER;\n        return squareWidth;\n    }\n    renderKhmerChess() {\n        for (let i = 0; i < TD_GRAVEYARD_NUMBER; i++) {\n            const square = this.graveyard.get(i);\n            square.removePiece();\n        }\n        this.khmerChess.graveyard().forEach((p, i) => {\n            const square = this.graveyard.get(i);\n            square.setPiece(new Piece(p.type, p.color));\n        });\n        this.khmerChess.board().forEach((arr, i) => {\n            arr.forEach((p, j) => {\n                const square = this.squares[i * boardHelper.ROW_NUMBER + j];\n                square.removePiece();\n                if (p) {\n                    square.setPiece(new Piece(p.type, p.color));\n                }\n            });\n        });\n    }\n}\n\nconsole.log(KhmerChess.name, KhmerChess.version);\nconsole.log(KhmerChessBoard.name, KhmerChessBoard.version);\n\nmodule.exports = { KhmerChessBoard, Graveyard, ...khmerChess };","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nclass Graveyard {\n    squares = [];\n    push(squarePiece) {\n        this.squares.push(squarePiece);\n    }\n    get(index) {\n        return this.squares[index];\n    }\n}\n\nmodule.exports = { Graveyard };","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { boardHelper } = require(\"khmer-chess\");\n\nclass SquarePiece {\n    x = 0;\n    y = 0;\n    get h() {\n        if (this.isGraveyard) {\n            return `${this.x}x`;\n        }\n        return boardHelper.HORIZONTAL_CODE_LETTERS[this.x];\n    }\n    get v() {\n        return this.y + 1;\n    }\n    get index() {\n        return this.y * boardHelper.ROW_NUMBER + this.x;\n    }\n    get indexCode() {\n        return `${this.h}${this.v}`;\n    }\n    isGraveyard = false;\n    container = document.createElement('td');\n    piece = null;\n    constructor(x, y, container, piece, isGraveyard) {\n        this.x = x;\n        this.y = y;\n        this.container = container;\n        this.setPiece(piece);\n        this.isGraveyard = isGraveyard;\n    }\n    removePiece() {\n        this.setPiece(null);\n    }\n    setPiece(piece) {\n        this.piece = piece;\n        this.drawPiece();\n    }\n    drawPiece() {\n        this.container.classList.remove('piece');\n        if (this.piece) {\n            this.container.classList.add('piece');\n            this.container.classList.add(`type-${this.piece.type}`);\n            this.container.classList.add(`color-${this.piece.color}`);\n        }\n    }\n}\n\nmodule.exports = { SquarePiece };","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { boardHelper } = require('khmer-chess');\nconst { SquarePiece } = require('./SquarePiece');\nconst { PIECES_SVG } = require('./svg');\n\nconst BORDER_WIDTH = 1\nconst MIN_SQUARE_WIDTH = 5\nconst TD_GRAVEYARD_NUMBER = 30;\nconst TABLE_CLASS = 'khmer-chess-board';\n\nfunction addCss() {\n    const width = this.options.width;\n    const squareWidth = this.squareWidth();\n    const pieceFontSize = width / 12;\n\n    let css = `\n      table.${TABLE_CLASS}  {\n        table-layout: fixed;\n        border-collapse: collapse;\n        border-spacing: 0px;\n        width: ${width}px;\n        text-align: center;\n        border: 0px;\n        padding: 0px;\n        margin: auto;\n        background-color: white;\n      }\n      table.${TABLE_CLASS} tr {\n        width: ${width}px;\n        height: ${squareWidth}px;\n      }\n      table.${TABLE_CLASS} td {\n        user-select: none;\n        background-color: #f4d1a6;\n        border: 1px solid white;\n        padding: 0px;\n        margin: 0px;\n        max-width: ${squareWidth}px;\n        max-height: ${squareWidth}px;\n      }\n      table.${TABLE_CLASS} td, table.${TABLE_CLASS} td::before {\n        font-size: ${pieceFontSize}px;\n      }\n      table.${TABLE_CLASS} td.piece::before {\n        width: ${squareWidth}px;\n        height: ${squareWidth}px;\n        background-size: ${squareWidth}px ${squareWidth}px;\n        display: block;\n        content: ' ';\n      }\n    `;\n    boardHelper.getColorArray().forEach((color) => {\n        boardHelper.getPieceCharArray().forEach((type) => {\n            css += `\n            table.${TABLE_CLASS} td.piece.type-${type}.color-${color}::before {\n                background-image: url('data:image/svg+xml;utf8,${encodeURIComponent(PIECES_SVG[color + type])}');\n            }\n              `;\n        });\n    });\n\n    const head = document.head || document.getElementsByTagName('head')[0];\n    const style = document.createElement('style');\n    head.appendChild(style);\n\n    style.type = 'text/css';\n    if (style.styleSheet) {\n        // This is required for IE8 and below.\n        style.styleSheet.cssText = css;\n    } else {\n        style.appendChild(document.createTextNode(css));\n    }\n}\n\nfunction drawBoard() {\n    const squareWidth = this.squareWidth();\n\n    const createTable = (parent = this.options.container) => {\n        const table = document.createElement('table');\n        table.classList.add(TABLE_CLASS);\n        parent.appendChild(table);\n        return table;\n    }\n    const createTbody = (parent) => {\n        const tbody = document.createElement('tbody');\n        parent.appendChild(tbody);\n        return tbody;\n    }\n    const createTr = (parent) => {\n        const tr = document.createElement('tr');\n        parent.appendChild(tr);\n        return tr;\n    }\n    const createTd = (parent) => {\n        const td = document.createElement('td');\n        parent.appendChild(td);\n        return td;\n    }\n\n    const table = createTable();\n    const tbody = createTbody(table);\n\n    for (let i = 0; i < boardHelper.ROW_NUMBER; i++) {\n        const tr = createTr(tbody);\n        for (let j = 0; j < boardHelper.ROW_NUMBER; j++) {\n            const td = createTd(tr);\n            td.style.cursor = 'pointer';\n            const squarePiece = new SquarePiece(j, boardHelper.ROW_NUMBER - i - 1, td, null);\n            this.squaresIndex[squarePiece.indexCode] = squarePiece;\n        }\n    }\n    Object.keys(this.squaresIndex).forEach((key) => {\n        this.squares[this.squaresIndex[key].index] = this.squaresIndex[key];\n    });\n\n    const graveyardContainerHeight = squareWidth + 10 * BORDER_WIDTH;\n    table.style.height += graveyardContainerHeight;\n    const trGraveyardContainer = createTr(tbody);\n    trGraveyardContainer.style.height = graveyardContainerHeight;\n    const tdGraveyardContainer = createTd(trGraveyardContainer);\n    tdGraveyardContainer.addEventListener('mousewheel', function (e) {\n        this.scrollLeft -= (e.wheelDelta);\n        e.preventDefault();\n    }, false);\n    tdGraveyardContainer.style.width = this.options.width;\n    tdGraveyardContainer.style.height = graveyardContainerHeight;\n    tdGraveyardContainer.style.overflowX = 'scroll';\n    tdGraveyardContainer.style.overflowY = 'hidden';\n    tdGraveyardContainer.colSpan = 8;\n    tdGraveyardContainer.style.padding = 8 * BORDER_WIDTH * this.options.width / 600;\n    tdGraveyardContainer.style.boxShadow = `inset 0 0 ${this.options.width / 60}px #000000`;\n    const tableGraveyard = createTable(tdGraveyardContainer);\n    const graveyardWidth = BORDER_WIDTH * (TD_GRAVEYARD_NUMBER - 1) + squareWidth * TD_GRAVEYARD_NUMBER;\n    tableGraveyard.style.width = graveyardWidth;\n    tableGraveyard.style.height = squareWidth;\n    const tbodyGraveyard = createTbody(tableGraveyard);\n    const trGraveyard = createTr(tbodyGraveyard);\n    trGraveyard.style.width = graveyardWidth;\n\n    for (let i = 0; i < TD_GRAVEYARD_NUMBER; i++) {\n        const tdGraveyard = createTd(trGraveyard);\n        const squarePiece = new SquarePiece(i, 0, tdGraveyard, null, true);\n        this.graveyard.push(squarePiece);\n    }\n\n    const fSize = 15 * this.options.width / 600;\n\n    const addBackground = (target, tObjects = []) => {\n        let bgImg = `url(\"data:image/svg+xml;utf8,`;\n        bgImg += `<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='${squareWidth}px' width='${squareWidth}px'>`;\n\n        tObjects.forEach((obj) => {\n            bgImg += `<text x='${obj.x}' y='${obj.y}' `;\n            bgImg += `fill='white' font-size='${fSize}'>${obj.t}</text>`;\n        })\n\n        bgImg += `</svg>\")`;\n        target.style.backgroundImage = bgImg;\n        target.style.backgroundRepeat = 'no-repeat';\n    }\n\n    const square = this.squaresIndex['a1'];\n    addBackground(square.container, [\n        {\n            x: squareWidth / 2 - squareWidth / 10,\n            y: squareWidth,\n            t: 'a'\n        }, {\n            x: 0,\n            y: squareWidth / 2 + squareWidth / 10,\n            t: '1'\n        }\n    ]);\n    square.container.style.backgroundRepeat = 'no-repeat';\n    for (let i = 1; i < boardHelper.ROW_NUMBER; i++) {\n        const c = boardHelper.HORIZONTAL_CODE_LETTERS[i];\n        const square = this.squaresIndex[`${c}1`];\n        addBackground(square.container, [{\n            x: squareWidth / 2 - squareWidth / 10,\n            y: squareWidth,\n            t: c\n        }]);\n    }\n    for (let i = 1; i < boardHelper.ROW_NUMBER; i++) {\n        const square = this.squaresIndex[`a${i + 1}`];\n        addBackground(square.container, [{\n            x: 0,\n            y: squareWidth / 2 + squareWidth / 10,\n            t: i + 1\n        }]);\n    }\n\n    for (let i = 0; i < TD_GRAVEYARD_NUMBER; i++) {\n        const square = this.graveyard.get(i);\n        addBackground(square.container, [{\n            x: squareWidth / 2 - squareWidth / 10,\n            y: squareWidth,\n            t: i + 1\n        }]);\n    }\n}\n\nmodule.exports = {\n    addCss,\n    drawBoard,\n    BORDER_WIDTH,\n    MIN_SQUARE_WIDTH,\n    TD_GRAVEYARD_NUMBER,\n    TABLE_CLASS\n};","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { boardHelper } = require(\"khmer-chess\");\n\nconst WOOD_COLORS = {\n    WHITE: '#ffffff',\n    BLACK: '#422007',\n}\n\nconst filterId = 'drop-shadow';\nconst SVG_FILTER = `<defs>\n<filter id=\"${filterId}\" height=\"130%\">\n  <feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"5\"/> \n  <feOffset dx=\"5\" dy=\"5\" result=\"offsetblur\"/> \n  <feMerge> \n    <feMergeNode/>\n    <feMergeNode in=\"SourceGraphic\"/> \n  </feMerge>\n</filter>\n</defs>`;\nconst PIECES_SVG = {\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_TOUK}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_SES}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_KOL}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_SDECH}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_NEANG}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_TREY}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_BORK}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.WHITE}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_TOUK}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_SES}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_KOL}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_SDECH}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_NEANG}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_TREY}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n    [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_BORK}`]: `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" viewBox=\"-10 0 1024 1000\">\n    ${SVG_FILTER}\n    <path fill=\"${WOOD_COLORS.BLACK}\" filter=\"url(#${filterId})\" \n d=\"M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10\n c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116\n c-51 28 -138 46 -239 46s-189 -19 -240 -47z\" />\n </svg>\n `,\n};\n\nmodule.exports = {\n    PIECES_SVG,\n};","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { KhmerChess } = require('./src/KhmerChess');\nconst boardHelper = require('./src/board-helper');\nconst REN = require('./src/REN');\nconst renHelper = require('./src/ren-helper');\nconst KPGN = require('./src/KPGN');\n\nmodule.exports = {\n  KhmerChess,\n  boardHelper,\n  ...REN,\n  renHelper,\n  KPGN,\n};","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { REN } = require(\"./REN\");\n\nclass Player {\n    name = '';\n    id = '';\n    constructor(id = '', name = '') {\n        this.id = id;\n        this.name = name;\n    }\n    toJson() {\n        return {\n            id: this.id,\n            name: this.name\n        };\n    }\n}\nclass Result {\n    win = 0;\n    draw = 0;\n    lost = 0;\n    constructor(win = 0, draw = 0, lost = 0) {\n        this.win = win;\n        this.draw = draw;\n        this.lost = lost;\n    }\n    toJson() {\n        return {\n            win: this.win,\n            draw: this.draw,\n            lost: this.lost\n        };\n    }\n}\nclass Move {\n    from = '';\n    to = '';\n    jump = false;\n    capture = ''\n    constructor(from = '', to = '', jump = false, capture = '') {\n        this.from = from;\n        this.to = to;\n        this.jump = jump;\n        this.capture = capture;\n    }\n    toJson() {\n        return {\n            from: this.from,\n            to: this.to,\n            jump: this.jump,\n            capture: this.capture\n        };\n    }\n}\nclass Timer {\n    totalSecond = 0;\n    currentWhite = 0;\n    currentBlack = 0;\n    constructor(totalSecond = 0, currentWhite = 0, currentBlack = 0) {\n        this.totalSecond = totalSecond;\n        this.currentWhite = currentWhite;\n        this.currentBlack = currentBlack;\n    }\n    toJson() {\n        return {\n            totalSecond: this.totalSecond,\n            currentWhite: this.currentWhite,\n            currentBlack: this.currentBlack\n        };\n    }\n}\n\nclass KPGN {\n    event = '';\n    date = '';\n    location = '';\n    players = {\n        white: new Player(),\n        black: new Player(),\n    }\n    result = {\n        last: {\n            whiteWin: false,\n            blackWin: false\n        },\n        white: new Result()\n    };\n    moves = [new Move()];\n    ren = new REN();\n    timer = new Timer();\n    constructor(kpgnJson) {\n    }\n    toJson() {\n        return {\n            event: this.event,\n            date: this.date,\n            location: this.location,\n            players: {\n                white: this.players.white.toJson(),\n                black: this.players.black.toJson(),\n            },\n            result: {\n                last: {\n                    whiteWin: this.result.last.whiteWin,\n                    blackWin: this.result.last.blackWin\n                },\n                white: this.result.white.toJson()\n            },\n            moves: this.moves.map((m) => m.toJson()),\n            ren: this.ren.toString(),\n            timer: this.timer.toJson()\n        }\n    }\n}\n\nmodule.exports = {\n    KPGN,\n    Player,\n    Result,\n    Move,\n    Timer\n};\n","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { KPGN } = require(\"./KPGN\");\nconst MoveHelper = require(\"./move-helper\");\nconst renHelper = require(\"./ren-helper\");\nconst config = require('../package.json');\n\nclass KhmerChess {\n  static name = config.name;\n  static version = config.version;\n  moveHelper = new MoveHelper();\n  renInstance = renHelper.toRen();\n  kpgnInstance = new KPGN();\n  constructor(renStr) {\n    this.renInstance = renHelper.toRen(renStr);\n  }\n  load(renStr) {\n    this.renInstance = renHelper.toRen(renStr);\n  }\n  reset() {\n    this.renInstance = renHelper.toRen();\n  }\n  /**\n   * Generate all available moves of current turn\n   */\n  moves() {\n    // TODO:\n    return [];\n  }\n  /**\n   * Is King is attacked (អុក), return under attack color\n   * \n   * return color|null\n   */\n  in_check() {\n    // TODO:\n    return null;\n  }\n  /**\n   * Is win, return lost color\n   * \n   * return color|null\n   */\n  in_checkmate() {\n    // TODO:\n    return null;\n  }\n  /**\n   * Is stuck (អាប់), return stuck color\n   * \n   * return color|null\n   */\n  in_stalemate() {\n    // TODO:\n    return null;\n  }\n  /**\n   * Is draw (ស្មើ)\n   * \n   * return boolean\n   */\n  in_draw() {\n    // TODO:\n    return false;\n  }\n  /**\n   * Is draw by counting over (ស្មើ​ដោយ​ការ​រាប់), return counter color\n   * \n   * return color|null\n   */\n  in_draw_count() {\n    // TODO:\n    return null;\n  }\n  /**\n   * Is game over, win|stuck|win-timeout|draw-count-over|win-resign\n   */\n  game_over() {\n    // TODO:\n    return false;\n  }\n  validate_ren(renStr) {\n    try {\n      renHelper.toRen(renStr);\n      return { valid: true, error_number: 0, error: 'No errors.' };\n    } catch (error) {\n      return { valid: false, error_number: 1, error: error.message };\n    }\n  }\n  ren() {\n    return this.renInstance.toString();\n  }\n  board() {\n    return this.renInstance.board.toMultiArray();\n  }\n  graveyard() {\n    return this.renInstance.graveyard.pieces;\n  }\n  // Khmer Portable Game Notation <file-name>.kpgn.json\n  kpgn() {\n    return this.kpgnInstance.toJson();\n  }\n  load_kpgn(kpgnJosn, options) {\n    this.kpgnInstance = new KPGN(kpgnJosn);\n  }\n  ascii() {\n    const arr = this.renInstance.board.toMultiArray();\n    let str = `  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓`;\n    const result = arr.reduce((s, subArr, i) => {\n      const rs = subArr.map((p) => ` ${p ? p.toString() : ' '} `).join('┃');\n      const bottom = i == arr.length - 1 ? '┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛' : '┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫';\n      s += `\n${8 - i} ┃${rs}┃\n  ${bottom}`;\n      return s;\n    }, str);\n    const gyTStr = this.renInstance.graveyard.pieces.map(() => '━━━').join('┳');\n    const gyStr = this.renInstance.graveyard.pieces.map((p) => ` ${p ? p.toString() : ' '} `).join('┃');\n    const gyBStr = this.renInstance.graveyard.pieces.map(() => '━━━').join('┻');\n    const graveyardStr = `  ┏${gyTStr}┓\n  ┃${gyStr}┃\n  ┗${gyBStr}┛`;\n    return `${result}\n    a   b   c   d   e   f   g   h\n${graveyardStr}`\n  }\n  turn() {\n    this.renInstance.turn;\n  }\n  /**\n   * Move piece regarding provided Move object\n   *\n   * @param Move move\n   */\n  move(move) {\n    // TODO:\n  }\n  /**\n   * Undo last move\n   * \n   * return {Piece, Move}|null\n   */\n  undo() {\n    // TODO:\n    return false;\n  }\n  /**\n   * Move all pieces to graveyard except kings\n   * -> 4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB\n   */\n  clear() {\n    this.renInstance = renHelper.toRen('4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB');\n  }\n  /**\n   * Move piece to square id location\n   *\n   * @param Piece piece\n   * @param String squareId\n   *\n   * return Piece|null\n   */\n  put(piece, squareId) {\n    // TODO: move piece to square id location\n    return null;\n  }\n  /**\n   * Get piece at square id location\n   *\n   * @param String squareId 'a1'\n   *\n   * return Piece|null\n   */\n  get(squareId) {\n    // TODO: get piece at square id location\n    return null;\n  }\n  /**\n   * Move piece to graveyard\n   *\n   * @param String squareId 'a1'\n   *\n   * return Piece|null\n   */\n  remove(squareId) {\n    // TODO: move piece to graveyard\n    return null;\n  }\n  history() {\n    return this.kpgnInstance.moves;\n  }\n  addUpdateRenderEventListener(listener) {\n    // TODO:\n  }\n  removeUpdateRenderEventListener(listener) {\n    // TODO:\n  }\n}\n\nmodule.exports = {\n  KhmerChess,\n};","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\nconst { PIECE_TYPE_BORK } = require(\"./board-helper\");\n/**\n * Raksa-Eng Notation\n * fen: <pieces on board> <turn w|b> <king&queen moved ----|SNsn> <king attack --|Kk> <countdown -.-|-.4> <pieces in graveyard>\n * e.g: bhgqkghb/8/ffffffff/8/8/FFFFFFFF/8/BHGKQGHB\n */\n\nconst boardHelper = require(\"./board-helper\");\nconst jsis = require(\"./jsis\");\n\n// bhgqkghb/8/ffffffff/8/8/FFFFFFFF/8/BHGKQGHB w ---- -- -.-\nconst DEFAULT_BOARD_STR = 'bhgqkghb/8/ffffffff/8/8/FFFFFFFF/8/BHGKQGHB';\nconst NOT_SET = '-';\nconst STRING_COUNT = 'B2F8G2H2K1Q1b2f8g2h2k1q1';\n\nclass Piece {\n    type = boardHelper.PIECE_TYPE_TREY;\n    color = boardHelper.PIECE_COLOR_WHITE;\n    get pCode() {\n        if (this.color == boardHelper.PIECE_COLOR_WHITE) {\n            return boardHelper.toWhitePiece(this.type);\n        }\n        return this.type;\n    }\n    constructor(t, c) {\n        if (jsis.isUndefined(c)) {\n            if (jsis.isUndefined(t)) {\n                t = boardHelper.toWhitePiece(boardHelper.PIECE_TYPE_TREY);\n            }\n            if (jsis.isUpperCase(t)) {\n                c = boardHelper.PIECE_COLOR_WHITE;\n            } else {\n                c = boardHelper.PIECE_COLOR_BLACK;\n            }\n            t = t.toLowerCase();\n        }\n        this.type = t;\n        this.color = c;\n    }\n    toOrigin() {\n        if (this.type == PIECE_TYPE_BORK) {\n            return new Piece(this.color, boardHelper.PIECE_TYPE_TREY);\n        }\n        return this;\n    }\n    toString() {\n        let c = this.type;\n        if (boardHelper.isWhite(this.color)) {\n            c = boardHelper.toWhitePiece(c);\n        }\n        return c;\n    }\n}\nclass Pos {\n    h = 'a';\n    v = 1;\n    x = 0;\n    y = 0;\n    p = new Piece();\n    constructor(p, h, v) {\n        this.p = p\n        if (jsis.isUndefined(v)) {\n            v = h.v;\n            h = h.h;\n        }\n        this.h = h;\n        this.v = v;\n        this.x = boardHelper.HORIZONTAL_CODE_LETTERS.indexOf(this.h);\n        this.y = this.v - 1;\n    }\n    toString() {\n        return `${this.toPString()}${this.h}${this.v}`;\n    }\n    toPString() {\n        return jsis.isNull(this.p) ? boardHelper.EMPTY_PIECE : this.p.toString();\n    }\n}\n/**\n * bhgqkghb/8/ffffffff/8/8/FFFFFFFF/8/BHGKQGHB => bhgqkghb/......../ffffffff/......../......../FFFFFFFF/......../BHGKQGHB\n */\nclass Board {\n    poses = Array.from({\n        length: boardHelper.getSubBoardNumber(),\n    }, (_, i) => {\n        const codeP = boardHelper.numToCodeP(i);\n        return new Pos(null, codeP);\n    });\n    constructor(boardStr) {\n        if (jsis.isUndefined(boardStr)) {\n            boardStr = DEFAULT_BOARD_STR;\n        }\n        const newBoardStr = this.extract(boardStr).replace(/\\//g, '');\n        if (newBoardStr.length < boardHelper.getSubBoardNumber() ||\n            !boardHelper.isValidPiecesString(newBoardStr)) {\n            throw new Error(`Invalid board string ${boardStr}`);\n        }\n        this.poses = newBoardStr.split('').map((c, i) => {\n            const codeP = boardHelper.numToCodeP(i);\n            return new Pos(c == boardHelper.EMPTY_PIECE ? null : new Piece(c), codeP);\n        });\n    }\n    toMultiArray() {\n        const arr = [[], [], [], [], [], [], [], []];\n        this.poses.forEach((pos) => {\n            arr[pos.y][pos.x] = pos.p;\n        });\n        return arr;\n    }\n    compress(str) {\n        const reg = new RegExp(`(\\\\${boardHelper.EMPTY_PIECE}+)`, 'g');\n        return str.replace(reg, ($1) => $1.length);\n    }\n    extract(str) {\n        return str.replace(/(\\d+)/g, ($1) => {\n            // $1 == 3 => '...', bh6 => 'bh......'\n            return Array.from({\n                length: $1\n            }, () => boardHelper.EMPTY_PIECE).join('');\n        });\n    }\n    toStringFull() {\n        const str = this.poses.map((pos, i) => {\n            const p = pos.toPString();\n            if (i && i % 8 == 0 && i != boardHelper.getSubBoardNumber()) {\n                return `${boardHelper.BOARD_SEPARATOR}${p}`;\n            }\n            return p;\n        }).join('');\n        return str;\n    }\n    toString() {\n        let str = this.toStringFull();\n        str = this.compress(str);\n        return str;\n    }\n}\nclass KqMoved {\n    whiteKing = false;\n    whiteQueen = false;\n    blackKing = false;\n    blackQueen = false;\n    constructor(kqMovedStr = '') {\n        const bh = boardHelper;\n        this.whiteKing = !!~kqMovedStr.indexOf(bh.toWhitePiece(bh.PIECE_TYPE_SDECH));\n        this.whiteQueen = !!~kqMovedStr.indexOf(bh.toWhitePiece(bh.PIECE_TYPE_NEANG));\n        this.blackKing = !!~kqMovedStr.indexOf(bh.PIECE_TYPE_SDECH);\n        this.blackQueen = !!~kqMovedStr.indexOf(bh.PIECE_TYPE_NEANG);\n    }\n    toString() {\n        let str = `${this.whiteKing ? boardHelper.toWhitePiece(boardHelper.PIECE_TYPE_SDECH) : NOT_SET}`;\n        str += `${this.whiteQueen ? boardHelper.toWhitePiece(boardHelper.PIECE_TYPE_NEANG) : NOT_SET}`;\n        str += `${this.blackKing ? boardHelper.PIECE_TYPE_SDECH : NOT_SET}`;\n        str += `${this.blackQueen ? boardHelper.PIECE_TYPE_NEANG : NOT_SET}`;\n        return str;\n    }\n}\nclass KAttacked {\n    whiteKing = false;\n    blackKing = false;\n    constructor(kAttackedStr = '') {\n        const bh = boardHelper;\n        this.whiteKing = !!~kAttackedStr.indexOf(bh.toWhitePiece(bh.PIECE_TYPE_SDECH));\n        this.blackKing = !!~kAttackedStr.indexOf(bh.PIECE_TYPE_SDECH);\n    }\n    toString() {\n        let str = `${this.whiteKing ? boardHelper.toWhitePiece(boardHelper.PIECE_TYPE_SDECH) : NOT_SET}`;\n        str += `${this.blackKing ? boardHelper.PIECE_TYPE_SDECH : NOT_SET}`;\n        return str;\n    }\n}\n// 23.-\nclass CountDown {\n    white = null;\n    black = null;\n    constructor(countdownStr = '') {\n        const newCountdownStr = countdownStr.split('.');\n        this.white = jsis.isStringNumber(newCountdownStr[0]) ? Number(newCountdownStr[0]) : null;\n        this.black = jsis.isStringNumber(newCountdownStr[1]) ? Number(newCountdownStr[1]) : null;\n        if (!jsis.isNull(this.white) && !jsis.isNull(this.white)) {\n            throw new Error(`Invalid countdown string ${countdownStr}`);\n        }\n    }\n    toString() {\n        let str = `${jsis.isNull(this.white) ? NOT_SET : this.white}`;\n        str += `.${jsis.isNull(this.black) ? NOT_SET : this.black}`;\n        return str;\n    }\n}\nclass Graveyard {\n    pieces = [];\n    constructor(graveyardStr = '') {\n        if (graveyardStr.length > 30 ||\n            !boardHelper.isValidPiecesString(graveyardStr, true)) {\n            throw new Error(`Invalid graveyard string ${graveyardStr}`);\n        }\n        this.pieces = graveyardStr.split('').map((c, i) => {\n            const p = new Piece(c);\n            if (p.type == boardHelper.PIECE_TYPE_SDECH) {\n                throw new Error(`King cannot die graveyard:${graveyardStr}`);\n            }\n            return p;\n        });\n    }\n    toString() {\n        return this.pieces.map((p) => {\n            return p.toString();\n        }).join('');\n    }\n}\nclass REN {\n    board = new Board();\n    turn = boardHelper.PIECE_COLOR_WHITE;\n    kqMoved = new KqMoved();\n    kAttacked = new KAttacked();\n    countdown = new CountDown();\n    graveyard = new Graveyard();\n    constructor(boardStr, turnStr = boardHelper.PIECE_COLOR_WHITE,\n        kqMovedStr, kAttackedStr, countdownStr, graveyardStr) {\n        this.board = new Board(boardStr);\n        this.turn = turnStr;\n        this.kqMoved = new KqMoved(kqMovedStr);\n        this.kqMoved = new KAttacked(kAttackedStr);\n        this.countdown = new CountDown(countdownStr);\n        this.graveyard = new Graveyard(graveyardStr);\n        const invalidPiecesString = this.isInvalidPieceCount();\n        if (invalidPiecesString) {\n            throw new Error(`Invalid piece string board:${boardStr}, graveyard:${graveyardStr}, count:${invalidPiecesString}`);\n        }\n    }\n    isInvalidPieceCount() {\n        const pieces = this.board.poses.map((pos) => {\n            return pos.p;\n        }).filter((p) => {\n            return !jsis.isNull(p);\n        }).concat(this.graveyard.pieces).map((p) => {\n            return p.toOrigin();\n        });\n        const piecesCount = pieces.reduce((obj, p) => {\n            obj[p.toString()] = obj[p.toString()] || 0;\n            obj[p.toString()]++;\n            return obj;\n        }, {});\n        const str = Object.keys(piecesCount).map((k) => `${k}${piecesCount[k]}`).sort().join('');\n        if (str == STRING_COUNT) {\n            return false;\n        }\n        return str;\n    }\n    toString() {\n        let str = this.board.toString();\n        str += ` ${this.turn.toString()}`;\n        str += ` ${this.kqMoved.toString()}`;\n        str += ` ${this.kAttacked.toString()}`;\n        str += ` ${this.countdown.toString()}`;\n        str += ` ${this.graveyard.toString()}`;\n        return str;\n    }\n}\n\nmodule.exports = {\n    Piece,\n    Pos,\n    Board,\n    KqMoved,\n    CountDown,\n    Graveyard,\n    REN,\n    DEFAULT_BOARD_STR\n};","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst jsis = require(\"./jsis\");\nconst genMask = require(\"./gen-mask\");\n\nclass Rectangle {\n    constructor(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    isContainsPoint(point) {\n        const { x, y } = point;\n        const isContainsPoint = this.x <= x &&\n            (this.x + this.width) >= x &&\n            this.y <= y &&\n            (this.y + this.height) >= y;\n        return isContainsPoint;\n    }\n}\nlet allPiecesString = null;\nconst boardHelper = {\n    HORIZONTAL_CODE_LETTERS: \"abcdefgh\",\n\n    PIECE_COLOR_WHITE: \"w\",\n    PIECE_COLOR_BLACK: \"b\",\n\n    PIECE_TYPE_TOUK: \"b\", // Boat\n    PIECE_TYPE_SES: \"h\", // Horse\n    PIECE_TYPE_KOL: \"g\", // General\n    PIECE_TYPE_SDECH: \"k\", // King\n    PIECE_TYPE_NEANG: \"q\", // Queen\n    PIECE_TYPE_TREY: \"f\", // Fish\n    PIECE_TYPE_BORK: \"t\", // Transform fish\n    EMPTY_PIECE: \".\",\n    BOARD_SEPARATOR: \"/\",\n\n    ROW_NUMBER: 8,\n    ROW_FIRST_INDEX: 0,\n    ROW_LAST_INDEX: 7,\n\n    mask: null,\n\n    getPieceCharArray() {\n        return [\n            this.PIECE_TYPE_TOUK,\n            this.PIECE_TYPE_SES,\n            this.PIECE_TYPE_KOL,\n            this.PIECE_TYPE_SDECH,\n            this.PIECE_TYPE_NEANG,\n            this.PIECE_TYPE_TREY,\n            this.PIECE_TYPE_BORK,\n        ];\n    },\n    getColorArray() {\n        return [\n            this.PIECE_COLOR_WHITE,\n            this.PIECE_COLOR_BLACK,\n        ];\n    },\n    isValidPiecesString(str, onlyPiece) {\n        if (jsis.isNull(allPiecesString)) {\n            allPiecesString = [\n                ...this.getPieceCharArray(),\n                ...this.getPieceCharArray().map((c) => this.toWhitePiece(c)),\n                this.EMPTY_PIECE,\n                this.BOARD_SEPARATOR,\n            ]\n        }\n        const ruler = onlyPiece ? allPiecesString.filter((c) => {\n            return !~[this.EMPTY_PIECE, this.BOARD_SEPARATOR].indexOf(c);\n        }) : allPiecesString;\n        return !str.split('').some((c) => {\n            return !~ruler.indexOf(c);\n        });\n    },\n\n    toWhitePiece: (str) => str.toUpperCase(),\n\n    isValidPosXY(point, y) {\n        if (jsis.isUndefined(point)) {\n            return false;\n        }\n        if (!jsis.isUndefined(y)) {\n            point = this.p(point, y);\n        }\n        return !jsis.isUndefined(point.x) && !jsis.isUndefined(point.y) &&\n            this.rect(0, 0, this.ROW_LAST_INDEX, this.ROW_LAST_INDEX).isContainsPoint(point);\n    },\n    isValidPiece: (piece) => piece != boardHelper.EMPTY_PIECE,\n    isWhite: (c) => c === boardHelper.PIECE_COLOR_WHITE,\n    isBlack: (c) => c === boardHelper.PIECE_COLOR_BLACK,\n    codeP: (h, v) => ({ h, v }),\n    p: (x, y) => ({ x, y }),\n    res: (width, height) => ({ width, height }),\n    rect: (x, y, width, height) => new Rectangle(x, y, width, height),\n    getSubBoardNumber: () => boardHelper.ROW_NUMBER * boardHelper.ROW_NUMBER,\n    nerdPosToXY(p) {\n        if (jsis.isNumber(p.x) && jsis.isNumber(p.y)) {\n            return p;\n        }\n        if (jsis.isNumber(p)) {\n            const x = p % this.ROW_NUMBER;\n            const y = Math.floor(p / this.ROW_NUMBER);\n            return this.p(x, y);\n        }\n        return null;\n    },\n    nerdXyToPos(point, y) {\n        if (!jsis.isUndefined(y)) {\n            return point + y * this.ROW_NUMBER;\n        }\n        return point.x + point.y * this.ROW_NUMBER;\n    },\n    isPosInBoard(posInBoard) {\n        return jsis.isNumber(posInBoard) &&\n            posInBoard >= 0 && posInBoard <= this.getSubBoardNumber() - 1;\n    },\n    getCharPieceFromString(piecesString, posInBoard) {\n        if (this.isPosInBoard(posInBoard) && piecesString.length === this.getSubBoardNumber()) {\n            return piecesString.charAt(posInBoard);\n        }\n        return this.EMPTY_PIECE;\n    },\n    getPieceProperties(code) {\n        const h = this.pieceHash[code];\n        return {\n            color: h ? h[0] : this.PIECE_COLOR_EMPTY,\n            type: h ? h[1] : this.EMPTY_PIECE,\n        };\n    },\n    getCharPieceInPos(posInBoard, piecesString) {\n        return this.getCharPieceFromString(piecesString, posInBoard);\n    },\n    getPieceInPos(posInBoard, y, piecesString) {\n        if (jsis.isNumber(y)) {\n            posInBoard = this.nerdXyToPos(posInBoard, y);\n        } else if (jsis.isString(y)) {\n            piecesString = y;\n        }\n        const piece = this.getCharPieceInPos(posInBoard, piecesString);\n        let color = this.PIECE_COLOR_WHITE, type = this.PIECE_TYPE_TREY;\n        if (this.isValidPiece(piece)) {\n            const pr = this.getPieceProperties(piece);\n            color = pr.color;\n            type = pr.type;\n        }\n        return {\n            isValidPiece: this.isValidPiece(piece),\n            color: color,\n            type: type,\n        };\n    },\n    convertMask(p, pos, color) {\n        const sign = this.isWhite(color) ? 1 : -1;\n        pos = this.nerdPosToXY(pos);\n        p.x = p.x * sign + pos.x;\n        p.y = p.y * sign + pos.y;\n        return this.isValidPosXY(p) ? this.nerdXyToPos(p) : null;\n    },\n    getPieceCanMovePoses(type, pos, color) {\n        const poses = [];\n        this.mask = this.mask || genMask(this);\n        this.mask[type].forEach((_pos) => {\n            const p = this.convertMask(this.p(_pos[0], _pos[1]), pos, color);\n            if (!jsis.isNull(p)) {\n                poses.push(p);\n            }\n        });\n        return poses;\n    },\n    getPieceCanMovePosesValid(type, pos, color, piecesString) {\n        const _poses = this.getPieceCanMovePoses(type, pos, color);\n        let p, distPiece;\n        const poses = [];\n        const n = _poses.length, thisPos = this.nerdPosToXY(pos);\n        for (let i = 0; i < n; i++) {\n            p = this.nerdPosToXY(_poses[i]);\n            distPiece = this.getPieceInPos(p.x, p.y, piecesString);\n            if (distPiece.isValidPiece) {\n                if (color === distPiece.color ||\n                    type === this.PIECE_TYPE_TREY && p.x === thisPos.x) {\n                    p = null;\n                }\n            } else {\n                if (type === this.PIECE_TYPE_TREY && p.x != thisPos.x) {\n                    p = null;\n                }\n            }\n            if (!jsis.isNull(p) && type === this.PIECE_TYPE_TOUK) {\n                const _x = thisPos.x,\n                    _y = thisPos.y;\n                let _n, _s;\n                if (p.x === thisPos.x) {\n                    _n = Math.abs(p.y - thisPos.y);\n                    _s = thisPos.y < p.y ? 1 : -1;\n                    while (--_n > 0) {\n                        if (this.getPieceInPos(_x, _y + _s * _n, piecesString).isValidPiece) {\n                            p = null;\n                            break;\n                        }\n                    }\n                } else if (p.y === thisPos.y) {\n                    _n = Math.abs(p.x - thisPos.x);\n                    _s = thisPos.x < p.x ? 1 : -1;\n                    while (--_n > 0) {\n                        if (this.getPieceInPos(_x + _s * _n, _y, piecesString).isValidPiece) {\n                            p = null;\n                            break;\n                        }\n                    }\n                }\n            }\n            if (!jsis.isNull(p)) {\n                poses.push(_poses[i]);\n            }\n        }\n        return poses;\n    },\n    replacePiecesString(piecesString, c, p) {\n        return piecesString.substring(0, p) + c + piecesString.substring(p + 1);\n    },\n    injectPiece(piecesString, pos1, pos2) {\n        const c = piecesString.charAt(pos1);\n        if (!this.isCharPiecesInBoard(c, piecesString)) {\n            return null;\n        }\n        piecesString = this.replacePiecesString(piecesString, this.EMPTY_PIECE, pos1);\n        piecesString = this.replacePiecesString(piecesString, c, pos2);\n        return piecesString;\n    },\n    getPieceCode(color, type) {\n        const val = color + type;\n        for (const k in this.pieceHash) {\n            if (val === this.pieceHash[k]) {\n                return k;\n            }\n        }\n        return this.EMPTY_PIECE;\n    },\n    getKingWillInDanger(color, piecesString) {\n        const kingPos = piecesString.indexOf(this.getPieceCode(color, this.PIECE_TYPE_SDECH));\n        const n = piecesString.length;\n        let _poses, p, j;\n        for (let i = 0; i < n; i++) {\n            p = this.getPieceInPos(i, piecesString);\n            if (p.isValidPiece && p.color != color && p.type === this.PIECE_TYPE_TOUK) {\n                _poses = this.getPieceCanMovePoses(p.type, i, p.color, piecesString);\n                for (j = 0; j < _poses.length; j++) {\n                    if (_poses[j] === kingPos) {\n                        return [this.numToCode(i), this.numToCode(kingPos)];\n                    }\n                }\n            }\n        }\n        return null;\n    },\n    getKingInDanger(color, piecesString) {\n        const kingPos = piecesString.indexOf(this.getPieceCode(color, this.PIECE_TYPE_SDECH));\n        const n = piecesString.length;\n        let _poses, p, j;\n        for (let i = 0; i < n; i++) {\n            p = this.getPieceInPos(i, piecesString);\n            if (p.isValidPiece && p.color != color) {\n                _poses = this.getPieceCanMovePosesValid(p.type, i, p.color, piecesString);\n                for (j = 0; j < _poses.length; j++) {\n                    if (_poses[j] === kingPos) {\n                        return [this.numToCode(i), this.numToCode(kingPos)];\n                    }\n                }\n            }\n        }\n        return null;\n    },\n    numToCodeP(number) {\n        return this.codeP(this.HORIZONTAL_CODE_LETTERS[number % 8], ((number / 8 | 0) + 1));\n    },\n    numToCode(number) {\n        const codeP = this.numToCodeP(number);\n        return `${codeP.h}${codeP.v}`;\n    },\n    generatePosesCanMove(type, pos, color, piecesString, isHaveMoved) {\n        let p;\n        const _poses = this.getPieceCanMovePosesValid(type, pos, color, piecesString);\n        const isHaveCaptured = this.isHaveCaptured(piecesString);\n        if (type === this.PIECE_TYPE_SDECH) {\n            if (!isHaveCaptured && !isHaveMoved) {\n                p = this.convertMask(this.p(2, 1), pos, color);\n                if (p && !this.getPieceInPos(p, piecesString).isValidPiece) {\n                    _poses.push(p);\n                }\n                p = this.convertMask(this.p(-2, 1), pos, color);\n                if (p && !this.getPieceInPos(p, piecesString).isValidPiece) {\n                    _poses.push(p);\n                }\n            }\n        } else if (type === this.PIECE_TYPE_NEANG) {\n            if (!isHaveCaptured && !isHaveMoved) {\n                p = this.convertMask(this.p(-0, 2), pos, color);\n                if (p && !this.getPieceInPos(p, piecesString).isValidPiece) {\n                    _poses.push(p);\n                }\n            }\n        }\n        const n = _poses.length;\n        const poses = [];\n        let str;\n        for (let i = 0; i < n; i++) {\n            str = this.injectPiece(piecesString, pos, _poses[i]);\n            if (jsis.isNull(this.getKingInDanger(color, str))) {\n                poses.push(this.numToCode(_poses[i]));\n            }\n        }\n        return poses;\n    },\n    isCharPiecesInBoard(c, piecesString) {\n        return !!~piecesString.indexOf(c);\n    },\n    getPiecesInBoard(piecesString) {\n        return piecesString.split(\"\").filter((c) => {\n            return this.isValidPiece(c);\n        });\n    },\n    isHaveCaptured(piecesString) {\n        return this.getPiecesInBoard(piecesString).length < this.ROW_NUMBER * 4;\n    },\n    filterPieceInBoard(piecesString) {\n        const whitePieces = [];\n        const blackPieces = [];\n        let c, prop, piece;\n        for (let i = 0; i < piecesString.length; i++) {\n            c = piecesString.charAt(i);\n            if (this.isValidPiece(c)) {\n                prop = this.getPieceProperties(c);\n                piece = {\n                    color: prop.color,\n                    type: prop.type,\n                    index: i,\n                    code: this.numToCode(i),\n                };\n                if (this.isWhite(piece.color)) {\n                    whitePieces.push(piece);\n                } else {\n                    blackPieces.push(piece);\n                }\n            }\n        }\n        return {\n            whitePieces: whitePieces,\n            blackPieces: blackPieces,\n        };\n    },\n    extractPiecesToArray(piecesString) {\n        piecesString = piecesString.split(\"\");\n        const pieceAll = {\n            [this.PIECE_COLOR_BLACK]: [],\n            [this.PIECE_COLOR_WHITE]: [],\n        };\n        piecesString.forEach((e) => {\n            if (e === this.EMPTY_PIECE) {\n                return;\n            }\n            const prop = this.getPieceProperties(e);\n            pieceAll[prop.color].push(prop.type);\n        });\n        return pieceAll;\n    },\n    isStateCount(c, piecesString) {\n        const allPieces = this.extractPiecesToArray(piecesString);\n        return allPieces[c].length === 1;\n    },\n    checkCountable(color, piecesString) {\n        const pieceAll = this.extractPiecesToArray(piecesString);\n        const weaker = pieceAll[color];\n        const stronger = pieceAll[this.oppositeColor(color)];\n        return weaker.length <= 2 && stronger.length >= 2;\n    },\n    checkCount(color, piecesString, force) {\n        const countChar = (str, c) => {\n            return str.join(\"\").split(c).length - 1;\n        };\n        const charExist = (str, c) => {\n            return !!~str.indexOf(c);\n        };\n\n        const pieceAll = this.extractPiecesToArray(piecesString);\n        const weaker = pieceAll[color];\n        const stronger = pieceAll[this.oppositeColor(color)];\n        if (weaker.length === 1 && stronger.length > 1) {\n            if (!charExist(stronger, this.PIECE_TYPE_TREY)) {\n                let count = 64;\n                const toukCount = countChar(stronger, this.PIECE_TYPE_TOUK);\n                if (toukCount) {\n                    count = toukCount > 1 ? 8 : 16;\n                } else if (countChar(stronger, this.PIECE_TYPE_KOL) > 1) {\n                    count = 22;\n                } else if (countChar(stronger, this.PIECE_TYPE_SES) > 1) {\n                    count = 32;\n                } else if (countChar(stronger, this.PIECE_TYPE_KOL)) {\n                    count = 44;\n                }\n                return [stronger.length + 1, count];\n            }\n            return [0, 64];\n        } else if (force && this.checkCountable(color, piecesString)) {\n            return [0, 64];\n        }\n        return null;\n    },\n\n    getHashKey(val) {\n        const keys = Object.keys(this.pieceHash).filter((key) => {\n            return this.pieceHash[key] === val;\n        });\n        return keys.length === 1 ? keys[0] : this.EMPTY_PIECE;\n    },\n    getPieceKeyByProp(prop) {\n        let prop1;\n        for (const key in this.pieceHash) {\n            prop1 = this.getPieceProperties(key);\n            if (prop.color === prop1.color && prop.type === prop1.type) {\n                return key;\n            }\n        }\n        return this.EMPTY_PIECE;\n    },\n    getPieceKeyByName(name) {\n        return this.getPieceKeyByProp({\n            color: name[0],\n            type: name[1],\n        });\n    },\n    oppositeColor(color) {\n        return this.isWhite(color) ? this.PIECE_COLOR_BLACK : this.PIECE_COLOR_WHITE;\n    },\n};\nboardHelper.pieceHash = {\n    \"a\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_TOUK,\n    \"b\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_SES,\n    \"c\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_KOL,\n    \"d\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_SDECH,\n    \"e\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_NEANG,\n    \"f\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_TREY,\n    \"g\": boardHelper.PIECE_COLOR_WHITE + boardHelper.PIECE_TYPE_BORK,\n    \"h\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_TOUK,\n    \"i\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_SES,\n    \"j\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_KOL,\n    \"k\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_SDECH,\n    \"l\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_NEANG,\n    \"m\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_TREY,\n    \"n\": boardHelper.PIECE_COLOR_BLACK + boardHelper.PIECE_TYPE_BORK,\n};\n\nmodule.exports = boardHelper;","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst boardHelper = require(\"./board-helper\");\n\nfunction genMask() {\n    const mask = {};\n    mask[boardHelper.PIECE_TYPE_TOUK] = [\n        [0, 1], [0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [0, 7], [0, 8],\n        [0, -1], [0, -2], [0, -3], [0, -4], [0, -5], [0, -6], [0, -7], [0, -8],\n        [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0],\n        [-1, 0], [-2, 0], [-3, 0], [-4, 0], [-5, 0], [-6, 0], [-7, 0], [-8, 0],\n    ];\n    mask[boardHelper.PIECE_TYPE_SES] = [\n        [-1, -2],\n        [1, -2],\n        [-2, -1],\n        [2, -1],\n        [-1, 2],\n        [1, 2],\n        [-2, 1],\n        [2, 1],\n    ];\n    mask[boardHelper.PIECE_TYPE_NEANG] = [\n        [-1, -1],\n        [1, -1],\n        [-1, 1],\n        [1, 1],\n    ];\n    mask[boardHelper.PIECE_TYPE_KOL] = mask[boardHelper.PIECE_TYPE_NEANG].concat([\n        [0, 1],\n    ]);\n    mask[boardHelper.PIECE_TYPE_SDECH] = mask[boardHelper.PIECE_TYPE_KOL].concat([\n        [0, -1],\n        [1, 0],\n        [-1, 0],\n    ]);\n    mask[boardHelper.PIECE_TYPE_TREY] = [\n        [0, 1],\n        [-1, 1],\n        [1, 1],\n    ];\n    mask[boardHelper.PIECE_TYPE_BORK] = mask[boardHelper.PIECE_TYPE_NEANG];\n    return mask;\n}\n\nmodule.exports = genMask;","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst jsis = {\n    isValid(v) {\n        return !this.isNull(v) && !this.isUndefined(v);\n    },\n    isNull(v) {\n        return v === null;\n    },\n    isUndefined(v) {\n        return typeof v === \"undefined\";\n    },\n    isString(str) {\n        return this.isValid(str) && typeof str === \"string\";\n    },\n    isNotEmpty(str) {\n        return this.isValidString(str) && str != \"\";\n    },\n    isNumber(n) {\n        return this.isValid(n) && typeof n === \"number\";\n    },\n    isStringNumber(n) {\n        return this.isString(n) && n != \"\" && !isNaN(Number(n));\n    },\n    isArray(arr) {\n        return this.isValid(arr) && arr instanceof Array;\n    },\n    isFunction(f) {\n        return this.isValid(f) && typeof f === \"function\";\n    },\n    isObject(o) {\n        return this.isValid(o) && o instanceof Object;\n    },\n    isBoolean(b) {\n        return this.isValid(b) && typeof b === \"boolean\";\n    },\n    isTrue(b) {\n        return this.isValidBoolean(b) && b;\n    },\n    isFalse(b) {\n        return this.isValidBoolean(b) && !b;\n    },\n    isPoint(p) {\n        const isPoint = this.isValid(p) &&\n            this.isValidObject(p) &&\n            this.isValidNumber(p.x) &&\n            this.isValidNumber(p.y);\n        return isPoint;\n    },\n    isSize(size) {\n        const isSize = this.isValid(size) &&\n            this.isValidObject(size) &&\n            this.isValidNumber(size.width) &&\n            this.isValidNumber(size.height);\n        return isSize;\n    },\n    isOdd(n) {\n        return !!(n % 2);\n    },\n    isEven(n) {\n        return !this.isOdd(n);\n    },\n    isUpperCase(str) {\n        return str === str.toUpperCase();\n    }\n};\n\nmodule.exports = jsis;","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst boardHelper = require(\"./board-helper\");\n\nclass MoveHelper {\n    init(option) {\n        this.piecesString = option.piecesString;\n        this.currentTurn = option.currentTurn;\n        this.isNeangMoved = option.isNeangMoved;\n        this.isSdechMoved = option.isSdechMoved;\n\n        this.genCanMove = option.genCanMove;\n        this.genCanMoveForAnother = option.genCanMoveForAnother;\n\n        this.whiteMoves = [];\n        this.blackMoves = [];\n\n        this.whiteKingInDanger = null;\n        this.whiteKingWillInDanger = null;\n        this.blackKingInDanger = null;\n        this.blackKingWillInDanger = null;\n\n        this.winColor = null;\n        this.stuckColor = null;\n    }\n\n    generateCanMoves() {\n        const filter = boardHelper.filterPieceInBoard(this.piecesString);\n        this.whiteMoves = filter.whitePieces;\n        this.blackMoves = filter.blackPieces;\n        const genMoves = (pieces) => {\n            for (let i = 0; i < pieces.length; i++) {\n                const type = pieces[i].type;\n                const isSdech = type === boardHelper.PIECE_TYPE_SDECH;\n                const isNeang = type === boardHelper.PIECE_TYPE_NEANG;\n                let isHaveMoved = this.isSdechMoved;\n                if (!isSdech) {\n                    isHaveMoved = isNeang ? this.isNeangMoved : false;\n                }\n                const canMoveIndexes = boardHelper.generatePosesCanMove(\n                    type,\n                    pieces[i].index,\n                    pieces[i].color,\n                    this.piecesString,\n                    isHaveMoved,\n                );\n                pieces[i].canMoveIndexes = canMoveIndexes;\n            }\n        };\n        genMoves(this.whiteMoves);\n        genMoves(this.blackMoves);\n    }\n\n    cleanPieceNoMove() {\n        const cleanMoves = (pieces) => {\n            let isTrue = true;\n            while (isTrue) {\n                isTrue = false;\n                for (let i = 0; i < pieces.length; i++) {\n                    const piece = pieces[i];\n                    if (!piece.canMoveIndexes || !piece.canMoveIndexes.length) {\n                        pieces.splice(i, 1);\n                        isTrue = true;\n                        break;\n                    }\n                }\n            }\n        };\n        cleanMoves(this.whiteMoves);\n        cleanMoves(this.blackMoves);\n    }\n\n    checkIfKingInDanger() {\n        this.whiteKingInDanger = boardHelper.getKingInDanger(\n            boardHelper.PIECE_COLOR_WHITE,\n            this.piecesString,\n        );\n        this.whiteKingWillInDanger = boardHelper.getKingWillInDanger(\n            boardHelper.PIECE_COLOR_WHITE,\n            this.piecesString,\n        );\n        this.blackKingInDanger = boardHelper.getKingInDanger(\n            boardHelper.PIECE_COLOR_BLACK,\n            this.piecesString,\n        );\n        this.blackKingWillInDanger = boardHelper.getKingWillInDanger(\n            boardHelper.PIECE_COLOR_BLACK,\n            this.piecesString,\n        );\n    }\n\n    genWinLost() {\n        if (this.whiteKingInDanger && !this.whiteMoves.length) {\n            this.winColor = boardHelper.PIECE_COLOR_BLACK;\n        } else if (this.blackKingInDanger && !this.blackMoves.length) {\n            this.winColor = boardHelper.PIECE_COLOR_WHITE;\n        }\n    }\n\n    getStuck() {\n        if (this.winColor) {\n            return;\n        }\n        if (boardHelper.isWhite(this.currentTurn) && !this.whiteMoves.length) {\n            this.stuckColor = boardHelper.PIECE_COLOR_WHITE;\n        } else if (boardHelper.isBlack(this.currentTurn) && !this.blackMoves.length) {\n            this.stuckColor = boardHelper.PIECE_COLOR_BLACK;\n        }\n    }\n\n    calcCanMove(option) {\n        this.init(option);\n        this.generateCanMoves();\n        this.cleanPieceNoMove();\n        let moves = [];\n        if (this.genCanMove) {\n            moves = boardHelper.isWhite(this.currentTurn) ? this.whiteMoves : this.blackMoves;\n        }\n        let anotherMoves = [];\n        if (this.genCanMoveForAnother) {\n            anotherMoves = boardHelper.isBlack(this.currentTurn) ? this.whiteMoves : this.blackMoves;\n        }\n        return {\n            moves,\n            anotherMoves,\n        };\n    }\n    calcState(option) {\n        this.init(option);\n        this.generateCanMoves();\n        this.cleanPieceNoMove();\n\n        this.checkIfKingInDanger();\n        this.genWinLost();\n        this.getStuck();\n        return {\n            blackKingInDanger: this.blackKingInDanger,\n            whiteKingInDanger: this.whiteKingInDanger,\n            blackKingWillInDanger: this.blackKingWillInDanger,\n            whiteKingWillInDanger: this.whiteKingWillInDanger,\n            winColor: this.winColor,\n            stuckColor: this.stuckColor,\n            blackCountable: boardHelper.checkCountable(\n                boardHelper.PIECE_COLOR_BLACK,\n                this.piecesString,\n            ),\n            whiteCountable: boardHelper.checkCountable(\n                boardHelper.PIECE_COLOR_WHITE,\n                this.piecesString,\n            ),\n        };\n    }\n    calCount(option) {\n        return {\n            countingBlack: boardHelper.checkCount(\n                boardHelper.PIECE_COLOR_BLACK,\n                option.piecesString, option.force,\n            ),\n            countingWhite: boardHelper.checkCount(\n                boardHelper.PIECE_COLOR_WHITE,\n                option.piecesString, option.force,\n            ),\n        };\n    }\n}\n\nmodule.exports = MoveHelper;","/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *----------------------------------------------------------------------------*/\n\n\"use strict\";\n\nconst { REN, DEFAULT_BOARD_STR } = require('./REN');\nconst jsis = require('./jsis');\n\nconst renHelper = {\n    toRen(fen) {\n        if (jsis.isUndefined(fen)) {\n            fen = DEFAULT_BOARD_STR;\n        }\n        const fenArr = fen.split(' ');\n        return new REN(fenArr[0], fenArr[1], fenArr[2], fenArr[3], fenArr[4], fenArr[5]);\n    }\n};\n\nmodule.exports = renHelper;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(497);\n"],"sourceRoot":""}
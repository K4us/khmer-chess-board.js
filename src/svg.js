/*
 * Copyright (c) 2021, K4us
 * Author: Raksa Eng <eng.raksa@gmail.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 *----------------------------------------------------------------------------*/

'use strict';

const { boardHelper } = require('khmer-chess');
const { isNumber } = require('khmer-chess/src/jsis');
const { BORDER_WIDTH } = require('./constance');

const WOOD_COLORS = {
   WHITE: '#ffffff',
   BLACK: '#422007',
}

const filterId = 'drop-shadow';
const SVG_FILTER = `<defs>
<filter id="${filterId}" height="130%">
  <feGaussianBlur in="SourceAlpha" stdDeviation="5"/> 
  <feOffset dx="5" dy="5" result="offsetblur"/> 
  <feMerge> 
    <feMergeNode/>
    <feMergeNode in="SourceGraphic"/> 
  </feMerge>
</filter>
</defs>`;
const PIECES_SVG = {
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_TOUK}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
    d="M506.824 315.526h0.364258c0.870117 0.394531 69.209 31.3027 114.183 47.3984c18.665 6.67871 72.2451 17.4453 121.243 45.1572c49 27.7119 96.5205 77.9189 99.8809 156.794c2.7832 65.3447 -12.3887 131.396 -30.3809 185.18
c8.23145 12.4023 13.4854 26.667 13.4854 42.3135c0 25.8242 -14.2959 47.8955 -32.6973 64.0117c-18.4043 16.1172 -41.9385 28.4521 -69.6709 38.7256c-55.4668 20.5479 -128.273 32.293 -208.651 32.293c-2.49414 0 -4.97949 -0.0136719 -7.46094 -0.0371094
c-0.0742188 -0.000976562 -0.149414 0.00292969 -0.225586 0c-2.48145 0.0234375 -4.9668 0.0371094 -7.46289 0.0371094c-80.3789 0 -153.183 -11.7451 -208.649 -32.293c-27.7344 -10.2734 -51.2676 -22.6084 -69.6709 -38.7256
c-18.4023 -16.1162 -32.6963 -38.1875 -32.6963 -64.0117c0 -15.6465 5.25195 -29.9111 13.4834 -42.3135c-17.9912 -53.7842 -33.1641 -119.835 -30.3799 -185.18c3.35938 -78.875 50.8789 -129.082 99.8789 -156.794s102.581 -38.4785 121.242 -45.1572
c44.9775 -16.0957 113.315 -47.0039 114.186 -47.3984zM507.005 376.377c-24.4873 10.7578 -64.0342 27.6738 -95.8076 39.043c-28.7568 10.291 -73.6152 19.1484 -112.664 41.2314c-17.8389 10.0908 -33.8027 21.791 -46.1377 37.1162
c1.07812 3.83594 4.18359 8.95215 11.9209 15.7285c10.3701 9.08301 28.1416 19.2119 51.3076 27.791c46.3281 17.1631 113.749 28.6348 188.253 28.6348c1.00977 0 2.01172 -0.00976562 3.0166 -0.0146484h0.225586
c1.00488 0.00585938 2.00684 0.0146484 3.01465 0.0146484c74.5059 0 141.923 -11.4717 188.254 -28.6348c23.167 -8.5791 40.9375 -18.708 51.3076 -27.791c7.73926 -6.77637 10.8438 -11.8926 11.9209 -15.7285c-12.333 -15.3252 -28.2979 -27.0254 -46.1367 -37.1162
c-39.0498 -22.083 -83.9072 -30.9404 -112.663 -41.2314c-31.7744 -11.3691 -71.3213 -28.2852 -95.8115 -39.043zM228.18 552.152c-0.654297 4.81641 -1.10938 9.8418 -1.33496 15.1094c-2.00391 47.0684 8.0332 97.3906 21.3359 141.947l0.137695 0.654297
c11.0156 7.61426 24.2178 14.998 39.3896 21.7217c53.876 23.876 131.451 39.5928 217.268 39.5928c0.639648 0 1.27734 -0.00683594 1.91797 -0.00976562v-0.00195312h0.111328h0.114258v0.00195312c0.638672 0.00292969 1.27832 0.00976562 1.91895 0.00976562
c85.8164 0 163.391 -15.7168 217.267 -39.5928c15.1699 -6.72363 28.374 -14.1074 39.3896 -21.7217l0.136719 -0.654297c13.3037 -44.5566 23.3408 -94.8789 21.3369 -141.947c-0.224609 -5.26758 -0.681641 -10.293 -1.33594 -15.1094
c-17.8906 15.5371 -40.9395 27.6416 -68.1943 37.7354c-54.9521 20.3574 -127.457 32.0918 -207.504 32.0918c-1.00781 0 -2.00977 -0.0117188 -3.01465 -0.0166016h-0.225586c-1.00488 0.00585938 -2.00684 0.0166016 -3.0166 0.0166016
c-80.0469 0 -152.55 -11.7344 -207.503 -32.0918c-27.2539 -10.0938 -50.3037 -22.1982 -68.1943 -37.7354zM262.021 775.557l0.0263672 0.120117c-9.91895 8.68848 -11.2852 13.8916 -11.2852 16.6924c0 2.80469 1.36621 8.00879 11.2852 16.6953
c9.91895 8.68457 27.3672 18.6895 50.2764 27.1748c45.8154 16.9727 112.931 28.4297 187.107 28.4297c2.49707 0 4.98145 -0.015625 7.46289 -0.0410156v-0.00292969h0.111328h0.114258v0.00292969c2.48145 0.0253906 4.96582 0.0410156 7.46094 0.0410156
c74.1768 0 141.292 -11.457 187.109 -28.4297c22.9082 -8.48535 40.3574 -18.4902 50.2764 -27.1748c9.91797 -8.68652 11.2842 -13.8906 11.2842 -16.6953c0 -2.80078 -1.36621 -8.00391 -11.2842 -16.6924l0.0244141 -0.120117
c-1.77148 0.818359 -3.56152 1.63281 -5.36914 2.43262c-62.5312 27.7129 -145.77 43.8975 -237.583 43.8975c-0.679688 0 -1.35547 -0.00878906 -2.0332 -0.0107422c-0.676758 0.00292969 -1.35059 0.0107422 -2.0293 0.0107422
c-91.8135 0 -175.054 -16.1846 -237.583 -43.8975c-1.80957 -0.799805 -3.59863 -1.61426 -5.37207 -2.43262z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_SES}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_KOL}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_SDECH}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_NEANG}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_TREY}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_WHITE}${boardHelper.PIECE_TYPE_BORK}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
     <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M243 500h514v36h-514v-36zM490 428h34v178h-34v-178zM507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89z
 M507 443c-127 0 -231 31 -240 70v1v10c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM267 600v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_TOUK}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.BLACK}" filter="url(#${filterId})" 
    d="M506.824 315.526h0.364258c0.870117 0.394531 69.209 31.3027 114.183 47.3984c18.665 6.67871 72.2451 17.4453 121.243 45.1572c49 27.7119 96.5205 77.9189 99.8809 156.794c2.7832 65.3447 -12.3887 131.396 -30.3809 185.18
c8.23145 12.4023 13.4854 26.667 13.4854 42.3135c0 25.8242 -14.2959 47.8955 -32.6973 64.0117c-18.4043 16.1172 -41.9385 28.4521 -69.6709 38.7256c-55.4668 20.5479 -128.273 32.293 -208.651 32.293c-2.49414 0 -4.97949 -0.0136719 -7.46094 -0.0371094
c-0.0742188 -0.000976562 -0.149414 0.00292969 -0.225586 0c-2.48145 0.0234375 -4.9668 0.0371094 -7.46289 0.0371094c-80.3789 0 -153.183 -11.7451 -208.649 -32.293c-27.7344 -10.2734 -51.2676 -22.6084 -69.6709 -38.7256
c-18.4023 -16.1162 -32.6963 -38.1875 -32.6963 -64.0117c0 -15.6465 5.25195 -29.9111 13.4834 -42.3135c-17.9912 -53.7842 -33.1641 -119.835 -30.3799 -185.18c3.35938 -78.875 50.8789 -129.082 99.8789 -156.794s102.581 -38.4785 121.242 -45.1572
c44.9775 -16.0957 113.315 -47.0039 114.186 -47.3984zM507.005 376.377c-24.4873 10.7578 -64.0342 27.6738 -95.8076 39.043c-28.7568 10.291 -73.6152 19.1484 -112.664 41.2314c-17.8389 10.0908 -33.8027 21.791 -46.1377 37.1162
c1.07812 3.83594 4.18359 8.95215 11.9209 15.7285c10.3701 9.08301 28.1416 19.2119 51.3076 27.791c46.3281 17.1631 113.749 28.6348 188.253 28.6348c1.00977 0 2.01172 -0.00976562 3.0166 -0.0146484h0.225586
c1.00488 0.00585938 2.00684 0.0146484 3.01465 0.0146484c74.5059 0 141.923 -11.4717 188.254 -28.6348c23.167 -8.5791 40.9375 -18.708 51.3076 -27.791c7.73926 -6.77637 10.8438 -11.8926 11.9209 -15.7285c-12.333 -15.3252 -28.2979 -27.0254 -46.1367 -37.1162
c-39.0498 -22.083 -83.9072 -30.9404 -112.663 -41.2314c-31.7744 -11.3691 -71.3213 -28.2852 -95.8115 -39.043zM228.18 552.152c-0.654297 4.81641 -1.10938 9.8418 -1.33496 15.1094c-2.00391 47.0684 8.0332 97.3906 21.3359 141.947l0.137695 0.654297
c11.0156 7.61426 24.2178 14.998 39.3896 21.7217c53.876 23.876 131.451 39.5928 217.268 39.5928c0.639648 0 1.27734 -0.00683594 1.91797 -0.00976562v-0.00195312h0.111328h0.114258v0.00195312c0.638672 0.00292969 1.27832 0.00976562 1.91895 0.00976562
c85.8164 0 163.391 -15.7168 217.267 -39.5928c15.1699 -6.72363 28.374 -14.1074 39.3896 -21.7217l0.136719 -0.654297c13.3037 -44.5566 23.3408 -94.8789 21.3369 -141.947c-0.224609 -5.26758 -0.681641 -10.293 -1.33594 -15.1094
c-17.8906 15.5371 -40.9395 27.6416 -68.1943 37.7354c-54.9521 20.3574 -127.457 32.0918 -207.504 32.0918c-1.00781 0 -2.00977 -0.0117188 -3.01465 -0.0166016h-0.225586c-1.00488 0.00585938 -2.00684 0.0166016 -3.0166 0.0166016
c-80.0469 0 -152.55 -11.7344 -207.503 -32.0918c-27.2539 -10.0938 -50.3037 -22.1982 -68.1943 -37.7354zM262.021 775.557l0.0263672 0.120117c-9.91895 8.68848 -11.2852 13.8916 -11.2852 16.6924c0 2.80469 1.36621 8.00879 11.2852 16.6953
c9.91895 8.68457 27.3672 18.6895 50.2764 27.1748c45.8154 16.9727 112.931 28.4297 187.107 28.4297c2.49707 0 4.98145 -0.015625 7.46289 -0.0410156v-0.00292969h0.111328h0.114258v0.00292969c2.48145 0.0253906 4.96582 0.0410156 7.46094 0.0410156
c74.1768 0 141.292 -11.457 187.109 -28.4297c22.9082 -8.48535 40.3574 -18.4902 50.2764 -27.1748c9.91797 -8.68652 11.2842 -13.8906 11.2842 -16.6953c0 -2.80078 -1.36621 -8.00391 -11.2842 -16.6924l0.0244141 -0.120117
c-1.77148 0.818359 -3.56152 1.63281 -5.36914 2.43262c-62.5312 27.7129 -145.77 43.8975 -237.583 43.8975c-0.679688 0 -1.35547 -0.00878906 -2.0332 -0.0107422c-0.676758 0.00292969 -1.35059 0.0107422 -2.0293 0.0107422
c-91.8135 0 -175.054 -16.1846 -237.583 -43.8975c-1.80957 -0.799805 -3.59863 -1.61426 -5.37207 -2.43262z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_SES}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.BLACK}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_KOL}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.BLACK}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_SDECH}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.BLACK}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_NEANG}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.BLACK}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_TREY}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.BLACK}" filter="url(#${filterId})" 
 d="M507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89zM507 443c-127 0 -231 31 -240 70v1v10
 c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM504 473h1h2c99 0 180 20 180 45s-81 46 -180 46s-180 -21 -180 -46s79 -45 177 -45zM267 573v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116
 c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
   [`${boardHelper.PIECE_COLOR_BLACK}${boardHelper.PIECE_TYPE_BORK}`]: `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="-10 0 1024 1000">
    ${SVG_FILTER}
    <path fill="${WOOD_COLORS.WHITE}" filter="url(#${filterId})" 
 d="M243 500h514v36h-514v-36zM490 428h34v178h-34v-178zM507 417c145 0 265 39 283 89c1 2 2 5 2 8v1v3v4v172v3v2v2c0 2 0 4 -1 6h-1c-15 51 -135 92 -283 92c-146 0 -266 -39 -283 -90c-1 -2 -2 -5 -2 -8v-3v-1v-1v-176v-2v-1v-3c0 -3 1 -6 2 -8c17 -50 138 -89 283 -89z
 M507 443c-127 0 -231 31 -240 70v1v10c9 39 114 70 240 70s229 -30 239 -69v-11l1 -1c-9 -39 -114 -70 -240 -70zM267 600v117c13 8 28 15 45 22c51 19 120 31 195 31s144 -12 195 -31c17 -6 31 -14 44 -22v-116c-51 28 -138 46 -239 46s-189 -19 -240 -47z" />
 </svg>
 `,
};

function addBackgroundNote(target, tObjects = [], squareWidth, fSize) {
   let bgImg = `url("data:image/svg+xml;utf8,`;
   bgImg += `<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='${squareWidth}px' width='${squareWidth}px'>`;

   tObjects.forEach((obj) => {
      bgImg += `<text x='${obj.x}' y='${obj.y}' `;
      bgImg += `fill='white' font-size='${fSize}'>${obj.t}</text>`;
   })

   bgImg += `</svg>")`;
   target.style.backgroundImage = bgImg;
}

function squareWidth(width) {
   if (isNaN(Number(width))) {
      throw new Error('Invalid width');
   }
   const sqWidth = (width - (boardHelper.ROW_NUMBER - 1) * BORDER_WIDTH) / boardHelper.ROW_NUMBER;
   return sqWidth;
}

module.exports = {
   PIECES_SVG,
   addBackgroundNote,
   squareWidth,
};